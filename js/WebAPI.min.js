function getContext(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm)return Xrm.Page.context;throw new Error("Context is not available.")}function getClientUrl(){return getContext().getClientUrl()}function getWebAPIPath(){return getClientUrl()+"/api/data/v8.0/"}function parseError(e){if(e&&(e.response||e.responseText)){var t=JSON.parse(e.response?e.response:e.responseText);return t.error?t.error.message:t.Message?t.Message:"Unexpected Error"}return"Unexpected Error"}function dateReviver(e,t){var n;return"string"==typeof t&&(n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/.exec(t))?new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6])):t}function getURLParameter(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function objectEquals(e,t){"use strict";if(null===e||void 0===e||null===t||void 0===t)return e===t;if(e instanceof Function)return e===t;if(e instanceof RegExp)return e===t;if(e===t||e.valueOf()===t.valueOf())return!0;if(Array.isArray(e)&&e.length!==t.length)return!1;if(e instanceof Date)return!1;if(!(e instanceof Object))return!1;if(!(t instanceof Object))return!1;var n=Object.keys(e);return Object.keys(t).every(function(e){return-1!==n.indexOf(e)})&&n.every(function(n){return objectEquals(e[n],t[n])})}function padLeft(e,t,n){return Array(t-String(e).length+1).join(n||"0")+e}"undefined"==typeof $&&($=parent.$,jQuery=parent.jQuery);var MK=MK||{};MK.WebAPI=MK.WebAPI||{},MK.WebAPI={data:{tempArray:[]},Create:function(e,t,n,a,r){if(!MK.Validation.isString(e))throw new Error("MK.WebAPI.Create entitySetName parameter must be a string.");if(!MK.Validation.isObject(t))throw new Error("MK.WebAPI.Create entityObject parameter must be a Object.");if(n&&!MK.Validation.isGuid(n))throw new Error("MK.WebAPI.Create callerId parameter must be a GUID(String) or null.");if(a&&!MK.Validation.isFunction(a))throw new Error("MK.WebAPI.Create successCallback parameter must be a function or null.");if(r&&!MK.Validation.isFunction(r))throw new Error("MK.WebAPI.Create errorCallback parameter must be a function or null.");var i=getWebAPIPath()+e,o=new XMLHttpRequest;o.open("POST",encodeURI(i),!0),o.setRequestHeader("Accept","application/json"),n&&o.setRequestHeader("MSCRMCallerID",n),o.setRequestHeader("Content-Type","application/json; charset=utf-8"),o.setRequestHeader("OData-MaxVersion","4.0"),o.setRequestHeader("OData-Version","4.0"),o.onreadystatechange=function(){4==this.readyState&&(o.onreadystatechange=null,204==this.status?a&&a(this.getResponseHeader("OData-EntityId")):r&&r(MK.WebAPI.errorHandler(this)))},o.send(JSON.stringify(t))},Retrieve:function(e,t,n,a,r,i,o,s,u,c){"use strict";var d=!1;if(!MK.Validation.isString(e))throw new Error("MK.WebAPI.Retrieve entitySetName parameter must be a string.");if(!t&&!MK.Validation.isString(n))throw new Error("MK.WebAPI.Retrieve uri parameter must be a string.");if(a&&!MK.Validation.isGuid(a))throw new Error("MK.WebAPI.Create callerId parameter must be a GUID(String) or null.");if(r&&!MK.Validation.isFunction(r))throw new Error("MK.WebAPI.Create successCallback parameter must be a function or null.");if(i&&!MK.Validation.isFunction(i))throw new Error("MK.WebAPI.Create errorCallback parameter must be a function or null.");if(s&&!MK.Validation.isString(s))throw new Error("MK.WebAPI.Create eTag parameter must be a String or null.");if(u&&!MK.Validation.isFunction(u))throw new Error("MK.WebAPI.Create unmodifiedCallback parameter must be a function or null.");if(t&&!MK.Validation.isString(t))throw new Error("MK.WebAPI.Retrieve entityId parameter must be a string.");if(!t&&n.indexOf("fetch")>-1&&(n.indexOf("mapping='logical'")>-1||n.indexOf('mapping="logical"')>-1)&&(n="fetchXml="+n,d=!0),n=t?e+"("+t+")":e+"?"+n,void 0===c&&(c=!0),!MK.Validation.isBoolean(c))throw new Error("MK.WebAPI.Retrieve async parameter must be a boolean.");var l=new Date;console.log("Retrieve Records (Start of execution) : Entity Name : "+e+" Current Timestamp :-  Hours : "+l.getHours()+" Minutes : "+l.getMinutes()+" Seconds : "+l.getSeconds()+" Milliseconds : "+l.getMilliseconds()),$.ajax({type:"GET",contentType:"application/json; charset=utf-8",datatype:"json",url:encodeURI(getWebAPIPath()+n),beforeSend:function(e){e.setRequestHeader("Accept","application/json"),e.setRequestHeader("Content-Type","application/json; odata.metadata=minimal"),e.setRequestHeader("OData-MaxVersion","4.0"),e.setRequestHeader("OData-Version","4.0"),a&&e.setRequestHeader("MSCRMCallerID",a),s&&e.setRequestHeader("If-None-Match",s),o&&e.setRequestHeader("Prefer",'odata.include-annotations="OData.Community.Display.V1.FormattedValue"')},async:c,success:function(t){var s=l.differenceInTime(new Date);if(console.log("Retrieve Records (End of execution) : Entity Name : "+e+"Timestamp Diff:-  Hours : "+s.hh+" Minutes : "+s.mm+" Seconds : "+s.ss),null!=t){var u=null;if(d)if(null!=t["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]){u=MK.WebAPI.getPagingCookie(t["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]);var p=JSON.parse(JSON.stringify(t),dateReviver),f=n.substring(n.indexOf("<entity"),n.indexOf("</fetch>"));MK.WebAPI.getNextPageFetchXML(e,f,a,o,r,i,u.pageCokies,u.pageNumber,p,c)}else{var p=JSON.parse(JSON.stringify(t),dateReviver);r(p)}else if(t["@odata.nextLink"]){var h=t;MK.WebAPI.GetNextPage(t["@odata.nextLink"],a,o,5e3,r,i,h)}else r(t)}},error:function(e){i(MK.WebAPI.errorHandler(e))}})},getPagingCookie:function(e){var t={},n=null;try{e=unescape(unescape(e)),n=parseInt(e.substring(e.indexOf("=")+1,e.indexOf("pagingcookie")).replace(/\"/g,"").trim()),e=e.substring(e.indexOf("pagingcookie"),e.indexOf("istracking")),e=e.substring(e.indexOf("=")+1,e.length),e=e.substring(1,e.length-2),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),e="paging-cookie='"+e+"'",t.pageCokies=e,t.pageNumber=n}catch(a){throw new Error(a)}return t},getNextPageFetchXML:function(e,t,n,a,r,i,o,s,u,c){"use strict";t=t.substring(t.indexOf("<entity name="),t.indexOf("</entity>")+9);var d=5e3,l=["<fetch count='"+d+"' page='"+s+"' "+o+" version='1.0' >",t,"</fetch>"].join("");l=l.encodeURIAdvanced(),l=e+"?fetchXml="+l;var p=new XMLHttpRequest;if(p.open("GET",getWebAPIPath()+l,c),p.setRequestHeader("Accept","application/json"),n&&p.setRequestHeader("MSCRMCallerID",n),p.setRequestHeader("Content-Type","application/json; charset=utf-8"),p.setRequestHeader("OData-MaxVersion","4.0"),p.setRequestHeader("OData-Version","4.0"),a&&p.setRequestHeader("Prefer",'odata.include-annotations="OData.Community.Display.V1.FormattedValue"'),p.setRequestHeader("Prefer","odata.include-annotations=*"),p.setRequestHeader("Prefer","odata.maxpagesize=10"),c)p.onreadystatechange=function(){if(4==p.readyState)switch(p.onreadystatechange=null,p.status){case 200:var o=JSON.parse(p.response,dateReviver);if(u.value=u.value.concat(o.value),o["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]){var s=MK.WebAPI.getPagingCookie(o["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]);MK.WebAPI.getNextPageFetchXML(e,t,n,a,r,i,s.pageCokies,s.pageNumber,u,c)}else r(u);break;default:i&&i(MK.WebAPI.errorHandler(p))}},p.send();else switch(p.send(),p.status){case 200:var f=JSON.parse(p.response,dateReviver);if(u.value.concat(f.value),f["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]){var h=MK.WebAPI.getPagingCookie(f["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"]);MK.WebAPI.getNextPageFetchXML(e,t,n,a,r,i,h.pageCokies,h.pageNumber,u,c)}else r(u);break;default:i&&i(MK.WebAPI.errorHandler(p))}},GetNextPage:function(e,t,n,a,r,i,o){var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Accept","application/json"),t&&s.setRequestHeader("MSCRMCallerID",t),s.setRequestHeader("OData-MaxVersion","4.0"),s.setRequestHeader("OData-Version","4.0"),n&&s.setRequestHeader("Prefer",'odata.include-annotations="mscrm.formattedvalue"'),a&&s.setRequestHeader("Prefer","odata.maxpagesize="+a),s.onreadystatechange=function(){if(4==this.readyState)if(s.onreadystatechange=null,200==this.status){var e=JSON.parse(this.response,dateReviver);e["@odata.nextLink"]?MK.WebAPI.GetNextPage(e["@odata.nextLink"],t,n,5e3,r,i,o):(o.value=o.value.concat(e.value),r&&r(o))}else i&&i(MK.WebAPI.errorHandler(this))},s.send()},Update:function(e,t,n,a,r,i){if(n&&!MK.Validation.isObject(n))throw new Error("MK.WebAPI.update updatedEntity parameter must be Object.");if(r&&!MK.Validation.isFunction(r))throw new Error("MK.WebAPI.update successCallback parameter must be a function or null.");if(i&&!MK.Validation.isFunction(i))throw new Error("Sdk.WebAPIPreview.update errorCallback parameter must be a function or null.");if(a&&!MK.Validation.isGuid(a))throw new Error("Sdk.WebAPIPreview.update callerId parameter must be a string or null.");if(!MK.Validation.isString(t))throw new Error("MK.WebAPI.Retrieve entityId parameter must be a string and GUID.");if(!MK.Validation.isString(e))throw new Error("MK.WebAPI.Retrieve entitySetName parameter must be a string.");var o=getWebAPIPath()+e+"("+t+")",s=new XMLHttpRequest;s.open("PATCH",encodeURI(o),!0),s.setRequestHeader("Accept","application/json"),a&&s.setRequestHeader("MSCRMCallerID",a),s.setRequestHeader("Content-Type","application/json; charset=utf-8"),s.setRequestHeader("OData-MaxVersion","4.0"),s.setRequestHeader("OData-Version","4.0"),s.onreadystatechange=function(){4==this.readyState&&(s.onreadystatechange=null,204==this.status?r&&r(this.getResponseHeader("OData-EntityId")):i&&i(MK.WebAPI.errorHandler(this)))},s.send(JSON.stringify(n))},Delete:function(e,t,n,a,r){if(!MK.Validation.isString(t))throw new Error("MK.WebAPI.Delete entityId parameter must be a string and GUID.");if(!MK.Validation.isString(e))throw new Error("MK.WebAPI.Delete entitySetName parameter must be a string.");if(n&&!MK.Validation.isFunction(n))throw new Error("MK.WebAPI.Delete successCallback parameter must be a function or null.");if(a&&!MK.Validation.isFunction(a))throw new Error("MK.WebAPI.Delete errorCallback parameter must be a function or null.");if(r&&!MK.Validation.isGuid(r))throw new Error("MK.WebAPI.Delete callerId parameter must be a string or null.");var i=getWebAPIPath()+e+"("+t+")",o=new XMLHttpRequest;o.open("DELETE",encodeURI(i),!0),o.setRequestHeader("Accept","application/json"),r&&o.setRequestHeader("MSCRMCallerID",r),o.setRequestHeader("Content-Type","application/json; charset=utf-8"),o.setRequestHeader("OData-MaxVersion","4.0"),o.setRequestHeader("OData-Version","4.0"),o.onreadystatechange=function(){4==this.readyState&&(o.onreadystatechange=null,204==this.status?n&&n():a&&a(MK.WebAPI.errorHandler(this)))},o.send()},getId:function(e){if(e||(e=10),!e)throw new Error("Length must be a number.");if(e>30)throw new Error("Length must be less than 30.");for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=0;e>a;a++)t+=n.charAt(Math.floor(Math.random()*n.length));return t},setLookupRequest:function(e,t,n,a){return e&&t&&n&&a&&(MK.Validation.isGuid(e)||alert("MK.WebAPI.batch.setLookupRequest required entityId to be Guid"),a[n+"@odata.bind"]=getWebAPIPath()+t+"("+e+")"),a},batch:{setLookupRequest:function(e,t,n,a){return e&&t&&n&&a&&(MK.Validation.isGuid(e)||alert("MK.WebAPI.batch.setLookupRequest required entityId to be Guid"),a[n+"@odata.bind"]=getWebAPIPath()+t+"("+e+")"),a},getRandomId:function(){return MK.WebAPI.getId()},getCreateRequest:function(e,t,n,a){var r=[];return r.push("--changeset_"+t),r.push("Content-Type: application/http"),r.push("Content-Transfer-Encoding:binary"),r.push("Content-ID: "+e),r.push(""),r.push("POST "+getWebAPIPath()+a+" HTTP/1.1"),r.push("Content-Type: application/json;type=entry"),r.push(""),r.push(JSON.stringify(n)),r.join("\r\n")},getAssociateRequest:function(e,t,n,a,r,i){if((MK.Validation.isGuid(n)||MK.Validation.isGuid(a))&&!i)throw new Error("Entity name is required if parentContectId or childContentId is GUID.");var o={};MK.Validation.isGuid(a)?o["@odata.id"]=getWebAPIPath()+i+"("+a+")":a.indexOf("$")<=0&&(a="$"+a),o["@odata.id"]=a;var s=[];return 0===!r.indexOf("Referenced")&&(r="Referenced"+r),MK.Validation.isGuid(n)?n=getWebAPIPath()+i+"("+n+")":n.indexOf("$")<=0&&(n="$"+n),s.push("--changeset_"+t),s.push("Content-Type: application/http"),s.push("Content-Transfer-Encoding:binary"),s.push("Content-ID: "+e),s.push(""),s.push("POST "+n+"/"+r+"/$ref HTTP/1.1"),s.push("Content-Type: application/json;type=entry"),s.push(""),s.push(JSON.stringify(o)),s.join("\r\n")},getBoundRequest:function(e,t,n,a,r,i){i.indexOf("Microsoft.Dynamics.CRM")<0&&(i="Microsoft.Dynamics.CRM."+i+"()");var o=getWebAPIPath()+a+"("+r+")/"+i,s=[];return s.push("--changeset_"+t),s.push("Content-Type: application/http"),s.push("Content-Transfer-Encoding:binary"),s.push("Content-ID: "+e),s.push(""),s.push("POST "+encodeURI(o)+" HTTP/1.1"),s.push("Content-Type: application/json;type=entry"),s.push(""),n&&s.push(JSON.stringify(n)),s.join("\r\n")},getUpdateRequest:function(e,t,n,a,r){var i="";i=MK.Validation.isGuid(a)?encodeURI(getWebAPIPath()+r+"("+a+")"):"$"+a;var o=[];return o.push("--changeset_"+t),o.push("Content-Type: application/http"),o.push("Content-Transfer-Encoding:binary"),o.push("Content-ID: "+e),o.push(""),o.push("PATCH "+i+" HTTP/1.1"),o.push("Content-Type: application/json;type=entry"),o.push(""),o.push(JSON.stringify(n)),o.join("\r\n")},getDeleteRequest:function(e,t,n,a){var r="";r=MK.Validation.isGuid(n)?encodeURI(getWebAPIPath()+a+"("+n+")"):"$"+n;var i=[];return i.push("--changeset_"+t),i.push("Content-Type: application/http"),i.push("Content-Transfer-Encoding:binary"),i.push("Content-ID: "+e),i.push(""),i.push("DELETE "+r+" HTTP/1.1"),i.push("Content-Type: application/json;type=entry"),i.push(""),i.join("\r\n")},getRetrieveRequest:function(){},Execute:function(e,t,n,a,r,i){if(void 0===i&&(i=!0),!MK.Validation.isBoolean(i))throw new Error("MK.WebAPI.Retrieve async parameter must be a boolean.");var o=["--batch_"+t];o.push("Content-Type: multipart/mixed;boundary=changeset_"+n),o.push("\n");var s=["\n"];s.push("--changeset_"+n+"--"),s.push(""),s.push("--batch_"+t),e=o.join("\r\n")+e.join("\r\n")+s.join("\r\n");var u=new Date;console.log("Execute Operation (Start of execution) : Current Timestamp :-  Hours : "+u.getHours()+" Minutes : "+u.getMinutes()+" Seconds : "+u.getSeconds()+" Milliseconds : "+u.getMilliseconds()),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",datatype:"json",url:encodeURI(getWebAPIPath()+"$batch"),data:e,beforeSend:function(e){e.setRequestHeader("Accept","application/json"),e.setRequestHeader("Content-Type","multipart/mixed;boundary=batch_"+t),e.setRequestHeader("OData-MaxVersion","4.0"),e.setRequestHeader("OData-Version","4.0")},async:i,success:function(e,t){if("timeout"===t)r(new Error("The operation has timed out. Please try again."));else{var n=u.differenceInTime(new Date);console.log("Execute Operation (End of execution) :-  Timestamp Diff:-  Hours : "+n.hh+" Minutes : "+n.mm+" Seconds : "+n.ss),a&&a(e)}},error:function(e,t){console.error("Error Status : "+t),r("timeout"===t?new Error("The operation has timed out. Please try again."):MK.WebAPI.errorHandler(e))}})},changeSet:function(){}},invokeBoundAction:function(e,t,n,a,r,i,o){n.indexOf("Microsoft.Dynamics.CRM")<0&&(n="Microsoft.Dynamics.CRM."+n);var s=getWebAPIPath()+e+"("+t+")/"+n,u=new XMLHttpRequest;u.open("POST",encodeURI(s),!0),u.setRequestHeader("Accept","application/json"),o&&u.setRequestHeader("MSCRMCallerID",o),u.setRequestHeader("Content-Type","application/json; charset=utf-8"),u.setRequestHeader("OData-MaxVersion","4.0"),u.setRequestHeader("OData-Version","4.0"),u.onreadystatechange=function(){if(4==this.readyState)if(u.onreadystatechange=null,200==this.status||201==this.status||204==this.status){if(r)switch(this.status){case 200:r(JSON.parse(this.response,dateReviver));break;case 201:case 204:r()}}else i&&i(MK.WebAPI.errorHandler(this))},a?u.send(JSON.stringify(a)):u.send()},invokeUnboundAction:function(e,t,n,a,r){var i=new Date;console.log("invokeUnboundAction (Start of execution) : Action Name : "+e+"Current Timestamp :-  Hours : "+i.getHours()+" Minutes : "+i.getMinutes()+" Seconds : "+i.getSeconds()+" Milliseconds : "+i.getMilliseconds()),$.ajax({type:"POST",contentType:"application/json; charset=utf-8",datatype:"json",url:encodeURI(getWebAPIPath()+e),data:t?JSON.stringify(t):null,beforeSend:function(e){e.setRequestHeader("Accept","application/json"),e.setRequestHeader("Content-Type","application/json; odata.metadata=minimal"),e.setRequestHeader("OData-MaxVersion","4.0"),e.setRequestHeader("OData-Version","4.0"),r&&e.setRequestHeader("MSCRMCallerID",r)},async:!0,success:function(t,r){if("timeout"===r)a(new Error("The operation has timed out. Please try again."));else{var o=i.differenceInTime(new Date);console.log("invokeUnboundAction Records (End of execution) : Action Name : "+e+" Timestamp Diff:-  Hours : "+o.hh+" Minutes : "+o.mm+" Seconds : "+o.ss),n(t)}},error:function(t,n){var r=i.differenceInTime(new Date);console.log("invokeUnboundAction Records (End of execution) : Action Name : "+e+" Timestamp Diff:-  Hours : "+r.hh+" Minutes : "+r.mm+" Seconds : "+r.ss),a("timeout"===n?new Error("The operation has timed out. Please try again."):MK.WebAPI.errorHandler(t))}})},Action:{getAddUsersToTeamTemplateRequest:function(e,t,n){var a={};return a.Record={},a.Record[e+"id"]=t,a.Record["@odata.type"]="Microsoft.Dynamics.CRM."+e,a.TeamTemplate={teamtemplateid:n},a}},tempCallback:function(e){MK.WebAPI.data.tempArray.append(e)},errorHandler:function(e){var t="";switch(e.status){case 503:return t=e.statusText+" Status Code:"+e.status+" The Web API Preview is not enabled.",console.log(t),new Error(t);default:return t="Status Code:"+e.status+" "+parseError(e),console.log(t),new Error("Status Code:"+e.status+" "+parseError(e))}}},MK.Validation=MK.Validation||{},MK.Validation={isString:function(e){return!(!e||"string"!=typeof e)},isObject:function(e){return!(!e||"object"!=typeof e)},isGuid:function(e){var t=new RegExp("^({|()?[0-9a-fA-F]{8}-([0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}(}|))?$");return!(!e||"string"!=typeof e||!t.test(e))},isFunction:function(e){return!(!e||"function"!=typeof e)},isArray:function(e){"use strict";return!(!e||!Array.isArray(e))},isNumber:function(e){"use strict";return!0},isBoolean:function(e){"use strict";return"boolean"==typeof e}},MK.Action=MK.Action||{},MK.Convert=MK.Convert||{},MK.Convert={hoursToMinutes:function(e){return MK.Validation.isNumber(e)?60*e:(Xrm.Utility.alertDialog("Function MK.Convert.hoursToMinutes: parameter should be should be number.",null),null)},minutesToHours:function(e){return MK.Validation.isNumber(e)?e/60:(Xrm.Utility.alertDialog("Function MK.Convert.minutesToHours: parameter should be should be number.",null),null)}},Array.prototype.append=function(e){if(e)for(var t=0;t<e.lengh;t++)this.push(e[i])},Array.prototype.contains=function(e,t){if(!t){var n=this.indexOf(e);return n>-1?n:!1}for(var a=0;a<this.length;a++)if(this[a][t]===e)return a;return!1},Date.monthAbbreviations=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),Date.monthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December"),Date.prototype.isWeekend=function(e,t){"use strict";var n=this;void 0!==e&&""!==e&&null!==e||(e=1),void 0!==t&&""!==t&&null!==t||(t=5);var a=n.getDay(),r=[0,1,2,3,4,5,6];return r=t>=e?r.slice(e,t+1):r.slice(e,7).concat(r.slice(0,t+1)),-1===r.indexOf(a)},Date.prototype.getFormatedWeek=function(e){var t=new Date(this),n=null;return n=e?new Date(e):t.addDays(6),t.getDate()+" "+Date.monthAbbreviations[t.getMonth()]+" "+t.getFullYear()+" - "+n.getDate()+" "+Date.monthAbbreviations[n.getMonth()]+" "+n.getFullYear()},Date.prototype.addDays=function(e){var t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t},Date.prototype.getSpecificDateFromDay=function(e,t){var n=this.getDay(),a=this.getDate()-n+(0==n?e+1:e+t);return new Date(this.setDate(a))},Date.prototype.getDateWithoutTime=function(){return new Date(this.getFullYear(),this.getMonth(),this.getDate())},Date.prototype.difference=function(e){var t=this.getDateWithoutTime(),n=e.getDateWithoutTime(),a=Math.abs(n.getTime()-t.getTime()),r=Math.ceil(a/864e5);return t>n?0-r:r},Date.prototype.differenceInTime=function(e){var t=this.getHours().toString()+":"+this.getMinutes().toString()+":"+this.getSeconds().toString(),n=e.getHours().toString()+":"+e.getMinutes().toString()+":"+e.getSeconds().toString(),a=new Date("January 1, 1970 "+t),r=new Date("January 1, 1970 "+n),i=Math.abs(a-r),o=Math.floor(i/1e3/60/60);10>o&&(o="0"+o),i-=1e3*o*60*60;var s=Math.floor(i/1e3/60);10>s&&(s="0"+s),i-=1e3*s*60;var u=Math.floor(i/1e3);return 10>u&&(u="0"+u),{hh:o,mm:s,ss:u}},Number.prototype.formatMoney=function(e,t,n){var a=this,e=isNaN(e=Math.abs(e))?2:e,t=void 0==t?".":t,n=void 0==n?",":n,r=0>a?"-":"",i=parseInt(a=Math.abs(+a||0).toFixed(e))+"",o=(o=i.length)>3?o%3:0;return r+(o?i.substr(0,o)+n:"")+i.substr(o).replace(/(\d{3})(?=\d)/g,"$1"+n)+(e?t+Math.abs(a-i).toFixed(e).slice(2):"")},String.prototype.replaceAll=function(e,t){var n=this;return n.replace(new RegExp(e,"g"),t)},String.prototype.replaceMultiple=function(e,t){var n=this;return n.split(e).join(t)},String.prototype.encodeURIAdvanced=function(){var e=this;return e=encodeURIComponent(e),e.replaceMultiple("'","%27").replaceMultiple("~","%7E").replaceMultiple("*","%2A").replaceMultiple("(","%28").replaceMultiple(")","%29").replaceMultiple("!","%21")};var dateFormat=function(){var e=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,n=/[^-+\dA-Z]/g,a=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e};return function(r,i,o){var s=dateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(r)||/\d/.test(r)||(i=r,r=void 0),r=r?new Date(r):new Date,isNaN(r))throw SyntaxError("invalid date");i=String(s.masks[i]||i||s.masks["default"]),"UTC:"==i.slice(0,4)&&(i=i.slice(4),o=!0);var u=o?"getUTC":"get",c=r[u+"Date"](),d=r[u+"Day"](),l=r[u+"Month"](),p=r[u+"FullYear"](),f=r[u+"Hours"](),h=r[u+"Minutes"](),g=r[u+"Seconds"](),m=r[u+"Milliseconds"](),M=o?0:r.getTimezoneOffset(),y={d:c,dd:a(c),ddd:s.i18n.dayNames[d],dddd:s.i18n.dayNames[d+7],m:l+1,mm:a(l+1),mmm:s.i18n.monthNames[l],mmmm:s.i18n.monthNames[l+12],yy:String(p).slice(2),yyyy:p,h:f%12||12,hh:a(f%12||12),H:f,HH:a(f),M:h,MM:a(h),s:g,ss:a(g),l:a(m,3),L:a(m>99?Math.round(m/10):m),t:12>f?"a":"p",tt:12>f?"am":"pm",T:12>f?"A":"P",TT:12>f?"AM":"PM",Z:o?"UTC":(String(r).match(t)||[""]).pop().replace(n,""),o:(M>0?"-":"+")+a(100*Math.floor(Math.abs(M)/60)+Math.abs(M)%60,4),S:["th","st","nd","rd"][c%10>3?0:(c%100-c%10!=10)*c%10]};return i.replace(e,function(e){return e in y?y[e]:e.slice(1,e.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.pattern=function(e,t){return dateFormat(this,e,t)},Number.prototype.padLeft=function(e,t){return Array(e-String(this).length+1).join(t||"0")+this};
